<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯»å®æ¸¸æˆï¼šå¤è€ç¥åº™çš„è°œé¢˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .page {
            width: 100%;
            max-width: 900px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.8s ease, opacity 0.8s ease;
            opacity: 0;
            transform: translateX(100%);
            position: absolute;
            pointer-events: none;
        }
        
        .page.active {
            opacity: 1;
            transform: translateX(0);
            pointer-events: all;
        }
        
        .page.previous {
            transform: translateX(-100%);
        }
        
        .container {
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            text-align: center;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 2.5rem;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            color: #ffd700;
        }
        
        h2 {
            margin-bottom: 15px;
            color: #f39c12;
        }
        
        p {
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 1.1rem;
        }
        
        .scene {
            height: 300px;
            margin: 20px 0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            background: #2c3e50;
            border: 3px solid #8b6914;
        }
        
        .scene-content {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .character {
            width: 60px;
            height: 60px;
            background: #e74c3c;
            border-radius: 50%;
            position: absolute;
            transition: all 1s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .object {
            position: absolute;
            transition: all 0.5s ease;
        }
        
        .book {
            width: 40px;
            height: 50px;
            background: #8e44ad;
            border-radius: 5px;
            top: 100px;
            left: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .temple {
            width: 120px;
            height: 100px;
            background: #e74c3c;
            border-radius: 10px 10px 0 0;
            bottom: 50px;
            right: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }
        
        .cave {
            width: 80px;
            height: 60px;
            background: #34495e;
            border-radius: 40px 40px 0 0;
            bottom: 50px;
            left: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }
        
        .mountain {
            width: 150px;
            height: 120px;
            background: #2ecc71;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            bottom: 50px;
            left: 300px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 20px;
            font-size: 30px;
        }
        
        .treasure {
            width: 60px;
            height: 40px;
            background: #ffd700;
            border: 3px solid #b8860b;
            border-radius: 5px;
            bottom: 80px;
            right: 170px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            opacity: 0;
            transform: scale(0);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            border: none;
            border-radius: 50px;
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .progress-container {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .progress-bar {
            height: 20px;
            background: #34495e;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #f39c12, #e74c3c);
            transition: width 0.5s ease;
        }
        
        .status-text {
            text-align: center;
            font-size: 1.2rem;
            min-height: 60px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .message-log {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            height: 150px;
            overflow-y: auto;
            margin-top: 20px;
            text-align: left;
        }
        
        .message {
            padding: 8px;
            border-left: 3px solid #f39c12;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0 5px 5px 0;
            animation: fadeIn 0.5s ease;
        }
        
        .success { border-left-color: #2ecc71; }
        .danger { border-left-color: #e74c3c; }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 8px 15px;
            font-size: 0.9rem;
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .animated-text {
            animation: fadeIn 1s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes treasureGlow {
            0% { box-shadow: 0 0 5px gold; }
            50% { box-shadow: 0 0 20px gold; }
            100% { box-shadow: 0 0 5px gold; }
        }
        
        .bounce { animation: bounce 0.5s ease; }
        .pulse { animation: pulse 2s infinite; }
        .treasure-glow { animation: treasureGlow 2s infinite; }
        
        .page-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 100;
        }
        
        .page-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .page-dot.active {
            background: #f39c12;
            transform: scale(1.2);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .scene {
                height: 200px;
            }
            
            .character {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .book, .temple, .cave, .mountain {
                transform: scale(0.8);
            }
        }
    </style>
</head>
<body>
    <!-- å°é¢é¡µ -->
    <div class="page active" id="cover-page">
        <div class="container">
            <h1 class="animated-text">å¯»å®æ¸¸æˆï¼šå¤è€ç¥åº™çš„è°œé¢˜</h1>
            <div class="scene">
                <div class="scene-content">
                    <div class="character pulse">ğŸ§­</div>
                    <div class="object book">ğŸ“š</div>
                    <div class="object temple">ğŸ›•</div>
                    <div class="object cave">ğŸ•³ï¸</div>
                    <div class="object mountain">â›°ï¸</div>
                    <div class="object treasure">ğŸ’</div>
                </div>
            </div>
            <p>è¸ä¸Šå†’é™©ä¹‹æ—…ï¼Œè§£å¼€å¤è€è°œé¢˜ï¼Œå¯»æ‰¾ä¼ è¯´ä¸­çš„å®è—ï¼</p>
            <div class="controls">
                <button id="start-game">å¼€å§‹æ¸¸æˆ</button>
            </div>
        </div>
    </div>
    
    <!-- å›¾ä¹¦é¦†é¡µ -->
    <div class="page" id="library-page">
        <div class="container">
            <h2>å¤è€å›¾ä¹¦é¦†</h2>
            <div class="scene">
                <div class="scene-content">
                    <div class="character" id="library-character">ğŸ§­</div>
                    <div class="object book pulse" id="ancient-book">ğŸ“š</div>
                </div>
            </div>
            <p>ä½ æ¥åˆ°äº†å¤è€çš„å›¾ä¹¦é¦†ï¼Œè¿™é‡Œå……æ»¡äº†å°˜å°çš„ä¹¦ç±å’Œç¥ç§˜çš„æ°”æ¯ã€‚</p>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill-1"></div>
                </div>
                <div class="status-text" id="status-text-1">å¯»æ‰¾çº¿ç´¢...</div>
            </div>
            <div class="action-buttons" id="action-buttons-1">
                <button class="action-btn" data-action="search">æœç´¢ä¹¦æ¶</button>
                <button class="action-btn" data-action="examine">æ£€æŸ¥å¤ä¹¦</button>
                <button class="action-btn" data-action="decode">è§£è¯»åœ°å›¾</button>
            </div>
            <div class="message-log" id="message-log-1"></div>
            <div class="controls">
                <button class="nav-btn" data-target="cover-page">è¿”å›</button>
                <button class="nav-btn" data-target="cave-page" id="next-from-library" disabled>å‰å¾€æ´ç©´</button>
            </div>
        </div>
    </div>
    
    <!-- æ´ç©´é¡µ -->
    <div class="page" id="cave-page">
        <div class="container">
            <h2>ç¥ç§˜æ´ç©´</h2>
            <div class="scene">
                <div class="scene-content">
                    <div class="character" id="cave-character">ğŸ§­</div>
                    <div class="object cave">ğŸ•³ï¸</div>
                </div>
            </div>
            <p>ä½ è¿›å…¥äº†é»‘æš—çš„æ´ç©´ï¼Œè¿™é‡Œå……æ»¡äº†æœªçŸ¥çš„å±é™©å’Œç§˜å¯†ã€‚</p>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill-2"></div>
                </div>
                <div class="status-text" id="status-text-2">æ¢ç´¢æ´ç©´...</div>
            </div>
            <div class="action-buttons" id="action-buttons-2">
                <button class="action-btn" data-action="explore">æ·±å…¥æ¢ç´¢</button>
                <button class="action-btn" data-action="paintings">æŸ¥çœ‹å£ç”»</button>
                <button class="action-btn" data-action="search-cave">å¯»æ‰¾çº¿ç´¢</button>
            </div>
            <div class="message-log" id="message-log-2"></div>
            <div class="controls">
                <button class="nav-btn" data-target="library-page">è¿”å›å›¾ä¹¦é¦†</button>
                <button class="nav-btn" data-target="mountain-page" id="next-from-cave" disabled>å‰å¾€é«˜å±±</button>
            </div>
        </div>
    </div>
    
    <!-- é«˜å±±é¡µ -->
    <div class="page" id="mountain-page">
        <div class="container">
            <h2>é«˜å±±ä¹‹å·…</h2>
            <div class="scene">
                <div class="scene-content">
                    <div class="character" id="mountain-character">ğŸ§­</div>
                    <div class="object mountain">â›°ï¸</div>
                </div>
            </div>
            <p>ä½ ç™»ä¸Šäº†é«˜å±±ä¹‹å·…ï¼Œä»è¿™é‡Œå¯ä»¥ä¿¯ç°æ•´ä¸ªå±±è°·ã€‚</p>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill-3"></div>
                </div>
                <div class="status-text" id="status-text-3">å¯»æ‰¾çº¿ç´¢...</div>
            </div>
            <div class="action-buttons" id="action-buttons-3">
                <button class="action-btn" data-action="search-mountain">æœç´¢å±±é¡¶</button>
                <button class="action-btn" data-action="view">è§‚å¯Ÿåœ°å½¢</button>
                <button class="action-btn" data-action="find-path">å¯»æ‰¾è·¯å¾„</button>
            </div>
            <div class="message-log" id="message-log-3"></div>
            <div class="controls">
                <button class="nav-btn" data-target="cave-page">è¿”å›æ´ç©´</button>
                <button class="nav-btn" data-target="temple-page" id="next-from-mountain" disabled>å‰å¾€ç¥åº™</button>
            </div>
        </div>
    </div>
    
    <!-- ç¥åº™é¡µ -->
    <div class="page" id="temple-page">
        <div class="container">
            <h2>å¤è€ç¥åº™</h2>
            <div class="scene">
                <div class="scene-content">
                    <div class="character" id="temple-character">ğŸ§­</div>
                    <div class="object temple">ğŸ›•</div>
                    <div class="object treasure" id="treasure-chest">ğŸ’</div>
                </div>
            </div>
            <p>ä½ æ¥åˆ°äº†å¤è€çš„ç¥åº™ï¼Œè¿™é‡Œå……æ»¡äº†ç¥ç§˜çš„èƒ½é‡ã€‚</p>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill-4"></div>
                </div>
                <div class="status-text" id="status-text-4">è§£å¼€è°œé¢˜...</div>
            </div>
            <div class="action-buttons" id="action-buttons-4">
                <button class="action-btn" data-action="puzzle">è§£å¼€è°œé¢˜</button>
                <button class="action-btn" data-action="key">å¯»æ‰¾é’¥åŒ™</button>
                <button class="action-btn" data-action="open">æ‰“å¼€å®ç®±</button>
            </div>
            <div class="message-log" id="message-log-4"></div>
            <div class="controls">
                <button class="nav-btn" data-target="mountain-page">è¿”å›é«˜å±±</button>
                <button class="nav-btn" data-target="treasure-page" id="next-from-temple" disabled>æŸ¥çœ‹å®è—</button>
            </div>
        </div>
    </div>
    
    <!-- å®è—é¡µ -->
    <div class="page" id="treasure-page">
        <div class="container">
            <h2>å®è—å‘ç°</h2>
            <div class="scene">
                <div class="scene-content">
                    <div class="character">ğŸ§­</div>
                    <div class="object treasure treasure-glow" style="opacity: 1; transform: scale(1.5);">ğŸ’</div>
                </div>
            </div>
            <p>æ­å–œä½ ï¼ä½ æˆåŠŸæ‰¾åˆ°äº†ä¼ è¯´ä¸­çš„å®è—ï¼</p>
            <div class="message-log" id="message-log-5">
                <div class="message success">ä½ è§£å¼€äº†æ‰€æœ‰è°œé¢˜ï¼Œæ‰¾åˆ°äº†æ™ºæ…§ä¹‹çŸ³ï¼</div>
                <div class="message success">è¿™é¢—å®çŸ³å°†èµ‹äºˆä½ æ— å°½çš„çŸ¥è¯†å’Œæ™ºæ…§ï¼</div>
            </div>
            <div class="controls">
                <button id="play-again">å†ç©ä¸€æ¬¡</button>
            </div>
        </div>
    </div>
    
    <!-- é¡µé¢æŒ‡ç¤ºå™¨ -->
    <div class="page-indicator">
        <div class="page-dot active" data-page="cover-page"></div>
        <div class="page-dot" data-page="library-page"></div>
        <div class="page-dot" data-page="cave-page"></div>
        <div class="page-dot" data-page="mountain-page"></div>
        <div class="page-dot" data-page="temple-page"></div>
        <div class="page-dot" data-page="treasure-page"></div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€ç®¡ç†
        class TreasureGame {
            constructor() {
                this.currentPage = 'cover-page';
                this.pages = [
                    'cover-page', 
                    'library-page', 
                    'cave-page', 
                    'mountain-page', 
                    'temple-page', 
                    'treasure-page'
                ];
                this.gameState = {
                    hasMap: false,
                    hasDecodedMap: false,
                    hasCaveClue: false,
                    hasMountainClue: false,
                    hasKey: false,
                    hasSolvedPuzzle: false,
                    hasFoundTreasure: false
                };
                
                this.initializeEventListeners();
                this.initializePageIndicator();
            }
            
            initializeEventListeners() {
                // å¼€å§‹æ¸¸æˆæŒ‰é’®
                document.getElementById('start-game').addEventListener('click', () => {
                    this.navigateTo('library-page');
                });
                
                // å†ç©ä¸€æ¬¡æŒ‰é’®
                document.getElementById('play-again').addEventListener('click', () => {
                    this.resetGame();
                    this.navigateTo('cover-page');
                });
                
                // å¯¼èˆªæŒ‰é’®
                document.querySelectorAll('.nav-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const targetPage = e.target.getAttribute('data-target');
                        this.navigateTo(targetPage);
                    });
                });
                
                // å„é¡µé¢çš„åŠ¨ä½œæŒ‰é’®
                this.initializeActionButtons();
            }
            
            initializeActionButtons() {
                // å›¾ä¹¦é¦†é¡µé¢åŠ¨ä½œ
                document.querySelectorAll('#action-buttons-1 button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const action = e.target.getAttribute('data-action');
                        this.performLibraryAction(action);
                    });
                });
                
                // æ´ç©´é¡µé¢åŠ¨ä½œ
                document.querySelectorAll('#action-buttons-2 button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const action = e.target.getAttribute('data-action');
                        this.performCaveAction(action);
                    });
                });
                
                // é«˜å±±é¡µé¢åŠ¨ä½œ
                document.querySelectorAll('#action-buttons-3 button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const action = e.target.getAttribute('data-action');
                        this.performMountainAction(action);
                    });
                });
                
                // ç¥åº™é¡µé¢åŠ¨ä½œ
                document.querySelectorAll('#action-buttons-4 button').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const action = e.target.getAttribute('data-action');
                        this.performTempleAction(action);
                    });
                });
            }
            
            initializePageIndicator() {
                const dots = document.querySelectorAll('.page-dot');
                dots.forEach(dot => {
                    dot.addEventListener('click', () => {
                        const page = dot.getAttribute('data-page');
                        this.navigateTo(page);
                    });
                });
            }
            
            navigateTo(pageId) {
                // æ›´æ–°é¡µé¢æŒ‡ç¤ºå™¨
                document.querySelectorAll('.page-dot').forEach(dot => {
                    dot.classList.remove('active');
                    if (dot.getAttribute('data-page') === pageId) {
                        dot.classList.add('active');
                    }
                });
                
                // éšè—å½“å‰é¡µé¢
                const currentPage = document.getElementById(this.currentPage);
                currentPage.classList.remove('active');
                currentPage.classList.add('previous');
                
                // æ˜¾ç¤ºæ–°é¡µé¢
                const newPage = document.getElementById(pageId);
                newPage.classList.remove('previous');
                newPage.classList.add('active');
                
                this.currentPage = pageId;
                
                // ä¸ºæ–°é¡µé¢æ·»åŠ åŠ¨ç”»
                this.animatePageContent(pageId);
            }
            
            animatePageContent(pageId) {
                switch(pageId) {
                    case 'library-page':
                        this.animateLibrary();
                        break;
                    case 'cave-page':
                        this.animateCave();
                        break;
                    case 'mountain-page':
                        this.animateMountain();
                        break;
                    case 'temple-page':
                        this.animateTemple();
                        break;
                    case 'treasure-page':
                        this.animateTreasure();
                        break;
                }
            }
            
            animateLibrary() {
                const character = document.getElementById('library-character');
                const book = document.getElementById('ancient-book');
                
                // é‡ç½®ä½ç½®
                character.style.left = '100px';
                character.style.top = '150px';
                
                // åŠ¨ç”»ï¼šè§’è‰²ç§»åŠ¨åˆ°ä¹¦çš„ä½ç½®
                setTimeout(() => {
                    character.style.left = '180px';
                    character.style.top = '120px';
                    character.classList.add('bounce');
                    
                    setTimeout(() => {
                        character.classList.remove('bounce');
                    }, 500);
                }, 500);
            }
            
            animateCave() {
                const character = document.getElementById('cave-character');
                
                // é‡ç½®ä½ç½®
                character.style.left = '300px';
                character.style.top = '100px';
                
                // åŠ¨ç”»ï¼šè§’è‰²ç§»åŠ¨åˆ°æ´ç©´
                setTimeout(() => {
                    character.style.left = '150px';
                    character.style.top = '150px';
                    character.classList.add('bounce');
                    
                    setTimeout(() => {
                        character.classList.remove('bounce');
                    }, 500);
                }, 500);
            }
            
            animateMountain() {
                const character = document.getElementById('mountain-character');
                
                // é‡ç½®ä½ç½®
                character.style.left = '100px';
                character.style.top = '100px';
                
                // åŠ¨ç”»ï¼šè§’è‰²ç§»åŠ¨åˆ°å±±é¡¶
                setTimeout(() => {
                    character.style.left = '400px';
                    character.style.top = '80px';
                    character.classList.add('bounce');
                    
                    setTimeout(() => {
                        character.classList.remove('bounce');
                    }, 500);
                }, 500);
            }
            
            animateTemple() {
                const character = document.getElementById('temple-character');
                const treasure = document.getElementById('treasure-chest');
                
                // é‡ç½®ä½ç½®
                character.style.left = '100px';
                character.style.top = '150px';
                treasure.style.opacity = '0';
                treasure.style.transform = 'scale(0)';
                
                // åŠ¨ç”»ï¼šè§’è‰²ç§»åŠ¨åˆ°ç¥åº™
                setTimeout(() => {
                    character.style.left = '500px';
                    character.style.top = '150px';
                    character.classList.add('bounce');
                    
                    setTimeout(() => {
                        character.classList.remove('bounce');
                        
                        // æ˜¾ç¤ºå®è—
                        if (this.gameState.hasKey && this.gameState.hasSolvedPuzzle) {
                            treasure.style.opacity = '1';
                            treasure.style.transform = 'scale(1)';
                            treasure.classList.add('pulse');
                        }
                    }, 500);
                }, 500);
            }
            
            animateTreasure() {
                const treasure = document.querySelector('#treasure-page .treasure');
                treasure.classList.add('treasure-glow');
            }
            
            async performLibraryAction(action) {
                const messageLog = document.getElementById('message-log-1');
                const nextButton = document.getElementById('next-from-library');
                const progressFill = document.getElementById('progress-fill-1');
                const statusText = document.getElementById('status-text-1');
                
                // ç¦ç”¨æ‰€æœ‰åŠ¨ä½œæŒ‰é’®
                document.querySelectorAll('#action-buttons-1 button').forEach(btn => {
                    btn.disabled = true;
                });
                
                // æ¨¡æ‹Ÿå»¶è¿Ÿ
                await this.delay(1000);
                
                let message;
                
                switch(action) {
                    case 'search':
                        message = "ä½ åœ¨ä¹¦æ¶ä¸Šæ‰¾åˆ°äº†ä¸€å¼ å¤è€çš„åœ°å›¾ï¼";
                        this.gameState.hasMap = true;
                        progressFill.style.width = '33%';
                        statusText.textContent = "æ‰¾åˆ°åœ°å›¾ï¼";
                        break;
                    case 'examine':
                        message = "ä½ å‘ç°å¤ä¹¦ä¸­è®°è½½äº†ç¥åº™çš„ç§˜å¯†å…¥å£ï¼";
                        this.gameState.hasDecodedMap = true;
                        progressFill.style.width = '66%';
                        statusText.textContent = "è·å¾—é‡è¦çº¿ç´¢ï¼";
                        break;
                    case 'decode':
                        if (this.gameState.hasMap) {
                            message = "ä½ æˆåŠŸè§£è¯»äº†åœ°å›¾ï¼Œå‘ç°å®è—è—åœ¨ç¥åº™ä¸­ï¼";
                            progressFill.style.width = '100%';
                            statusText.textContent = "åœ°å›¾è§£è¯»å®Œæˆï¼";
                            nextButton.disabled = false;
                        } else {
                            message = "ä½ éœ€è¦å…ˆæ‰¾åˆ°åœ°å›¾æ‰èƒ½è¿›è¡Œè§£è¯»ï¼";
                            this.addMessage(messageLog, message, 'danger');
                            
                            // é‡æ–°å¯ç”¨æŒ‰é’®
                            document.querySelectorAll('#action-buttons-1 button').forEach(btn => {
                                btn.disabled = false;
                            });
                            return;
                        }
                        break;
                }
                
                this.addMessage(messageLog, message, 'success');
                
                // å¦‚æœå·²ç»å®Œæˆæ‰€æœ‰æ¡ä»¶ï¼Œå¯ç”¨ç»§ç»­æŒ‰é’®
                if (this.gameState.hasMap && this.gameState.hasDecodedMap) {
                    nextButton.disabled = false;
                }
                
                // é‡æ–°å¯ç”¨æŒ‰é’®
                document.querySelectorAll('#action-buttons-1 button').forEach(btn => {
                    btn.disabled = false;
                });
            }
            
            async performCaveAction(action) {
                const messageLog = document.getElementById('message-log-2');
                const nextButton = document.getElementById('next-from-cave');
                const progressFill = document.getElementById('progress-fill-2');
                const statusText = document.getElementById('status-text-2');
                
                // ç¦ç”¨æ‰€æœ‰åŠ¨ä½œæŒ‰é’®
                document.querySelectorAll('#action-buttons-2 button').forEach(btn => {
                    btn.disabled = true;
                });
                
                // æ¨¡æ‹Ÿå»¶è¿Ÿ
                await this.delay(1000);
                
                let message;
                
                switch(action) {
                    case 'explore':
                        message = "ä½ åœ¨æ´ç©´æ·±å¤„å‘ç°äº†ä¸€å¹…ç¥ç§˜çš„å£ç”»ï¼";
                        this.gameState.hasCaveClue = true;
                        progressFill.style.width = '33%';
                        statusText.textContent = "å‘ç°å£ç”»ï¼";
                        break;
                    case 'paintings':
                        if (this.gameState.hasCaveClue) {
                            message = "å£ç”»æ˜¾ç¤ºå®è—è—åœ¨ç¥åº™æ·±å¤„ï¼";
                            progressFill.style.width = '66%';
                            statusText.textContent = "è§£è¯»å£ç”»æˆåŠŸï¼";
                        } else {
                            message = "ä½ éœ€è¦å…ˆæ¢ç´¢æ´ç©´æ‰¾åˆ°å£ç”»ï¼";
                            this.addMessage(messageLog, message, 'danger');
                            
                            // é‡æ–°å¯ç”¨æŒ‰é’®
                            document.querySelectorAll('#action-buttons-2 button').forEach(btn => {
                                btn.disabled = false;
                            });
                            return;
                        }
                        break;
                    case 'search-cave':
                        message = "ä½ åœ¨æ´ç©´ä¸­æ‰¾åˆ°äº†ä¸€æŠŠå¤è€çš„é’¥åŒ™ï¼";
                        this.gameState.hasKey = true;
                        progressFill.style.width = '100%';
                        statusText.textContent = "æ‰¾åˆ°é’¥åŒ™ï¼";
                        nextButton.disabled = false;
                        break;
                }
                
                this.addMessage(messageLog, message, 'success');
                
                // å¦‚æœå·²ç»å®Œæˆæ‰€æœ‰æ¡ä»¶ï¼Œå¯ç”¨ç»§ç»­æŒ‰é’®
                if (this.gameState.hasCaveClue && this.gameState.hasKey) {
                    nextButton.disabled = false;
                }
                
                // é‡æ–°å¯ç”¨æŒ‰é’®
                document.querySelectorAll('#action-buttons-2 button').forEach(btn => {
                    btn.disabled = false;
                });
            }
            
            async performMountainAction(action) {
                const messageLog = document.getElementById('message-log-3');
                const nextButton = document.getElementById('next-from-mountain');
                const progressFill = document.getElementById('progress-fill-3');
                const statusText = document.getElementById('status-text-3');
                
                // ç¦ç”¨æ‰€æœ‰åŠ¨ä½œæŒ‰é’®
                document.querySelectorAll('#action-buttons-3 button').forEach(btn => {
                    btn.disabled = true;
                });
                
                // æ¨¡æ‹Ÿå»¶è¿Ÿ
                await this.delay(1000);
                
                let message;
                
                switch(action) {
                    case 'search-mountain':
                        message = "ä½ åœ¨å±±é¡¶æ‰¾åˆ°äº†ç¥åº™çš„éšè—å…¥å£ï¼";
                        this.gameState.hasMountainClue = true;
                        progressFill.style.width = '33%';
                        statusText.textContent = "å‘ç°å…¥å£ï¼";
                        break;
                    case 'view':
                        if (this.gameState.hasMountainClue) {
                            message = "ä½ ä»å±±é¡¶çœ‹åˆ°äº†ç¥åº™çš„å…¨è²Œï¼";
                            progressFill.style.width = '66%';
                            statusText.textContent = "è§‚å¯Ÿå®Œæˆï¼";
                        } else {
                            message = "ä½ éœ€è¦å…ˆæœç´¢å±±é¡¶æ‰¾åˆ°å…¥å£ï¼";
                            this.addMessage(messageLog, message, 'danger');
                            
                            // é‡æ–°å¯ç”¨æŒ‰é’®
                            document.querySelectorAll('#action-buttons-3 button').forEach(btn => {
                                btn.disabled = false;
                            });
                            return;
                        }
                        break;
                    case 'find-path':
                        message = "ä½ æ‰¾åˆ°äº†ä¸€æ¡é€šå¾€ç¥åº™çš„ç§˜å¯†è·¯å¾„ï¼";
                        progressFill.style.width = '100%';
                        statusText.textContent = "æ‰¾åˆ°è·¯å¾„ï¼";
                        nextButton.disabled = false;
                        break;
                }
                
                this.addMessage(messageLog, message, 'success');
                
                // å¦‚æœå·²ç»å®Œæˆæ‰€æœ‰æ¡ä»¶ï¼Œå¯ç”¨ç»§ç»­æŒ‰é’®
                if (this.gameState.hasMountainClue) {
                    nextButton.disabled = false;
                }
                
                // é‡æ–°å¯ç”¨æŒ‰é’®
                document.querySelectorAll('#action-buttons-3 button').forEach(btn => {
                    btn.disabled = false;
                });
            }
            
            async performTempleAction(action) {
                const messageLog = document.getElementById('message-log-4');
                const nextButton = document.getElementById('next-from-temple');
                const progressFill = document.getElementById('progress-fill-4');
                const statusText = document.getElementById('status-text-4');
                const treasure = document.getElementById('treasure-chest');
                
                // ç¦ç”¨æ‰€æœ‰åŠ¨ä½œæŒ‰é’®
                document.querySelectorAll('#action-buttons-4 button').forEach(btn => {
                    btn.disabled = true;
                });
                
                // æ¨¡æ‹Ÿå»¶è¿Ÿ
                await this.delay(1000);
                
                let message;
                
                switch(action) {
                    case 'puzzle':
                        message = "ä½ æˆåŠŸè§£å¼€äº†ç¥åº™çš„å¤è€è°œé¢˜ï¼";
                        this.gameState.hasSolvedPuzzle = true;
                        progressFill.style.width = '33%';
                        statusText.textContent = "è°œé¢˜è§£å¼€ï¼";
                        break;
                    case 'key':
                        if (this.gameState.hasKey) {
                            message = "ä½ å·²ç»æœ‰äº†é’¥åŒ™ï¼";
                            progressFill.style.width = '66%';
                            statusText.textContent = "é’¥åŒ™å·²å‡†å¤‡ï¼";
                        } else {
                            message = "ä½ éœ€è¦åœ¨æ´ç©´ä¸­å¯»æ‰¾é’¥åŒ™ï¼";
                            this.addMessage(messageLog, message, 'danger');
                            
                            // é‡æ–°å¯ç”¨æŒ‰é’®
                            document.querySelectorAll('#action-buttons-4 button').forEach(btn => {
                                btn.disabled = false;
                            });
                            return;
                        }
                        break;
                    case 'open':
                        if (this.gameState.hasKey && this.gameState.hasSolvedPuzzle) {
                            message = "å®ç®±æ‰“å¼€äº†ï¼é‡Œé¢æ˜¯ä¼ è¯´ä¸­çš„æ™ºæ…§ä¹‹çŸ³ï¼";
                            progressFill.style.width = '100%';
                            statusText.textContent = "å®è—æ‰¾åˆ°ï¼";
                            
                            // æ˜¾ç¤ºå®è—åŠ¨ç”»
                            treasure.style.opacity = '1';
                            treasure.style.transform = 'scale(1)';
                            treasure.classList.add('pulse');
                            
                            // å¯ç”¨ç»§ç»­æŒ‰é’®
                            nextButton.disabled = false;
                        } else {
                            message = "ä½ éœ€è¦å…ˆæ‰¾åˆ°é’¥åŒ™å¹¶è§£å¼€è°œé¢˜æ‰èƒ½æ‰“å¼€å®ç®±ï¼";
                            this.addMessage(messageLog, message, 'danger');
                            
                            // é‡æ–°å¯ç”¨æŒ‰é’®
                            document.querySelectorAll('#action-buttons-4 button').forEach(btn => {
                                btn.disabled = false;
                            });
                            return;
                        }
                        break;
                }
                
                this.addMessage(messageLog, message, 'success');
                
                // å¦‚æœå·²ç»å®Œæˆæ‰€æœ‰æ¡ä»¶ï¼Œå¯ç”¨ç»§ç»­æŒ‰é’®
                if (this.gameState.hasKey && this.gameState.hasSolvedPuzzle && action === 'open') {
                    nextButton.disabled = false;
                }
                
                // é‡æ–°å¯ç”¨æŒ‰é’®
                document.querySelectorAll('#action-buttons-4 button').forEach(btn => {
                    btn.disabled = false;
                });
            }
            
            addMessage(messageLog, text, type = '') {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${type}`;
                messageElement.textContent = text;
                messageLog.appendChild(messageElement);
                messageLog.scrollTop = messageLog.scrollHeight;
            }
            
            resetGame() {
                // é‡ç½®æ¸¸æˆçŠ¶æ€
                this.gameState = {
                    hasMap: false,
                    hasDecodedMap: false,
                    hasCaveClue: false,
                    hasMountainClue: false,
                    hasKey: false,
                    hasSolvedPuzzle: false,
                    hasFoundTreasure: false
                };
                
                // é‡ç½®è¿›åº¦æ¡
                document.querySelectorAll('.progress-fill').forEach(fill => {
                    fill.style.width = '0%';
                });
                
                // é‡ç½®çŠ¶æ€æ–‡æœ¬
                document.querySelectorAll('.status-text').forEach(text => {
                    if (text.id === 'status-text-1') text.textContent = 'å¯»æ‰¾çº¿ç´¢...';
                    if (text.id === 'status-text-2') text.textContent = 'æ¢ç´¢æ´ç©´...';
                    if (text.id === 'status-text-3') text.textContent = 'å¯»æ‰¾çº¿ç´¢...';
                    if (text.id === 'status-text-4') text.textContent = 'è§£å¼€è°œé¢˜...';
                });
                
                // æ¸…ç©ºæ¶ˆæ¯æ—¥å¿—
                document.querySelectorAll('.message-log').forEach(log => {
                    if (log.id !== 'message-log-5') log.innerHTML = '';
                });
                
                // ç¦ç”¨ç»§ç»­æŒ‰é’®
                document.querySelectorAll('.nav-btn[data-target]').forEach(btn => {
                    if (!btn.getAttribute('data-target').includes('cover-page') && 
                        !btn.getAttribute('data-target').includes('library-page')) {
                        btn.disabled = true;
                    }
                });
                
                // å¯ç”¨åŠ¨ä½œæŒ‰é’®
                document.querySelectorAll('.action-btn').forEach(btn => {
                    btn.disabled = false;
                });
            }
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        document.addEventListener('DOMContentLoaded', () => {
            new TreasureGame();
        });
    </script>
</body>
</html>